{% extends 'employer_documentation/base-ed-template.html' %}

{% block sidenav_extra %}
<div class="row">
    <div class="col px-0">
        <a class="nav-link side-nav-link {% if url_name == 'employer_detail_route' %}active{% endif %}" href="{% url 'employer_detail_route' employer_pk=request.resolver_match.kwargs.employer_pk %}">
        <p class="m-1 pl-2">Employer Profile</p>
        </a>
    </div>
</div>
<div class="row">
    <div class="col px-0">
        <a class="nav-link side-nav-link {% if url_name == 'employer_update_route' %}active{% endif %}" href="{% url 'employer_update_route' employer_pk=request.resolver_match.kwargs.employer_pk %}">
        <p class="m-1 pl-2">Edit Employer</p>
        </a>
    </div>
</div>
<div class="row">
    <div class="col px-0">
        <a class="nav-link side-nav-link {% if url_name == 'employerdoc_list_route' %}active{% endif %}" href="{% url 'employerdoc_list_route' employer_pk=request.resolver_match.kwargs.employer_pk %}">
        <p class="m-1 pl-2">Documents Summary</p>
        </a>
    </div>
</div>
<div class="row">
    <div class="col px-0">
        <a class="nav-link side-nav-link {% if url_name == 'employerdoc_create_route' %}active{% endif %}" href="{% url 'employerdoc_create_route' employer_pk=request.resolver_match.kwargs.employer_pk %}">
        <p class="m-1 pl-2">Add Document</p>
        </a>
    </div>
</div>
{% endblock sidenav_extra %}

{% block ed_section %}
    <h2>Employer Docs</h2>
    {% if object_list.count %}
        <h4>{{ object_list.0.employer.employer_name }}</h4>
        <h4>{{ object_list.0.employer.employer_mobile_number }}</h4>
    {% endif %}

    <div class="d-flex row justify-content-end mx-0 pr-3 pb-3">
        <a href="{% url 'employerdoc_create_route' employer_pk=request.resolver_match.kwargs.employer_pk %}" class="btn btn-secondary btn-sm">Create document</a>
    </div>

    <table class="table table-hover">
        <thead>
            <tr>
                <th scope="col">Ref No.</th>
                <th scope="col">FDW</th>
                <th scope="col">Agreement Date</th>
                <th scope="col">Work Commence</th>
                <th scope="col">FDW Status</th>
                <th scope="col">Action</th>
            </tr>
        </thead>
        <tbody>
        {% if object_list.count %}
            {% for object in object_list %}
            <tr>
                <td><a href="{% url 'employerdoc_detail_route' employer_pk=object.employer.pk employerdoc_pk=object.pk %}">{{ object.case_ref_no }}</a></td>
                <td><a href="{% url 'maid_detail' pk=object.fdw.pk %}">{{ object.fdw.reference_number }} - {{ object.fdw.name }}</a></td>
                <td><a href="{% url 'employerdoc_update_route' employer_pk=object.employer.pk employerdoc_pk=object.pk %}">{% if object.agreement_date|date:"d/m/y" %}{{ object.agreement_date|date:"d/m/y" }}{% else %}Add{% endif %}</a></td>
                <td><a href="{% url 'employerdoc_status_update_route' employer_pk=object.employer.pk employerdoc_pk=object.pk employersubdoc_pk=object.rn_maidstatus_ed.pk %}">{% if object.rn_maidstatus_ed.fdw_work_commencement_date %}{{ object.rn_maidstatus_ed.fdw_work_commencement_date|date:"d/m/y" }}{% else %}Add{% endif %}</a></td>
                <td><a href="{% url 'employerdoc_status_update_route' employer_pk=object.employer.pk employerdoc_pk=object.pk employersubdoc_pk=object.rn_maidstatus_ed.pk %}">{% if object.rn_maidstatus_ed.is_deployed %}<i class="far fa-check-circle text-success"></i>{% else %}<i class="far fa-times-circle text-danger"></i>{% endif %}</a></td>
                <td><a href="{% url 'employerdoc_update_route' employer_pk=object.employer.pk employerdoc_pk=object.pk %}"><i class="fas fa-edit"></i></a>&emsp;{% if request.user.groups.all.0.name == 'Agency Owners' %}<a href="{% url 'employerdoc_delete_route' employer_pk=object.employer.pk employerdoc_pk=object.pk %}"><i class="fas fa-trash"></i></a>{% endif %}</td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="6">No results found. Click <a href="{% url 'employerdoc_create_route' employer_pk=request.resolver_match.kwargs.employer_pk %}">here</a> to create doumentation.</td>
            </tr>
        {% endif %}
        </tbody>
    </table>
{% endblock ed_section %}