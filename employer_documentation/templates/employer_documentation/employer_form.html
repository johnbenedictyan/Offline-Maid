{% extends 'employer_documentation/base-ed-template.html' %}

{% block sidenav_extra %}
{% if object.employer_doc %}
    <!-- {% comment %}Sub Documents{% endcomment %} -->
    {% include 'employer_documentation/sidenav_subdocument_snippet.html' %}
{% elif object.employer %}
    <!-- {% comment %}Documents{% endcomment %} -->
    {% include 'employer_documentation/sidenav_document_snippet.html' %}

    <div class="row">
        <div class="col px-0">
            <a class="nav-link side-nav-link " data-toggle="collapse" href="#forms-nav" role="button" aria-expanded="false" aria-controls="forms">
            <p class="m-1 pl-2">Form Sections<i class="fa fa-caret-down float-right align-middle"></i></p>
            </a>
        </div>
    </div>
    <div class="row">
        <div class="col px-0">
            <ul class="collapse" id="forms-nav">
                <li>
                    <a href="#id-doc-general">Top</a>
                </li>
                <li>
                    <a href="#id-doc-service-fee-schedule">Service & Fees Schedule</a>
                </li>
                <li>
                    <a href="#id-doc-service-agreement">Service Agreement</a>
                </li>
                <li>
                    <a href="#id-doc-employment-contract">Employment Contract</a>
                </li>
            </ul>
        </div>
    </div>
{% elif object.employer_name %}
    <!-- {% comment %}Employers{% endcomment %} -->
    <div class="row">
        <div class="col px-0">
            <a class="nav-link side-nav-link " href="{% url 'employer_detail_route' employer_pk=object.pk %}">
            <p class="m-1 pl-2">Employer Profile</p>
            </a>
        </div>
    </div>
{% endif %}
{% endblock sidenav_extra %}

{% block ed_section %}
    {% if form.errors %}
        {% for field in form %}
            {% for error in field.errors %}
            <div class="alert alert-danger">
                <strong>{{ error|escape }}</strong>
            </div>
            {% endfor %}
        {% endfor %}
    {% endif %}
    
    <div class="container">
        {% block form %}{% endblock form %}
    </div>
{% endblock ed_section %}

{% block js %}
    <script>
        let replacementFdwSelector = document.querySelector('#id_fdw_is_replacement');
        if (replacementFdwSelector) {
            let fdwReplacedField = document.querySelector('#div_id_fdw_replaced');
            let loanTransferredField = document.querySelector('#div_id_b4_loan_transferred');
            if (replacementFdwSelector.value!=='True') {
                fdwReplacedField.hidden = true;
                loanTransferredField.hidden = true;
            }
            replacementFdwSelector.addEventListener('change', () => {
                if (replacementFdwSelector.value!=='True') {
                fdwReplacedField.hidden = true;
                loanTransferredField.hidden = true;
                }
                else {
                fdwReplacedField.hidden = false;
                loanTransferredField.hidden = false;
                }
            })
        }

        function copyToClipboard(){
            // Select the element with ID = "CopyMeID", can be a div, p, or a span, possibly others
            var textToCopy = document.getElementById("copy-id");
            var copyButton = document.getElementById('copy-button');
            
            // Animate copy button
            copyButton.children[0].animate([
                { transform: 'scale(1)' },
                { transform: 'scale(2)' },
                { transform: 'scale(1)' },
            ], {
                duration: 500, //milliseconds
                easing: 'ease-in', //'linear', a bezier curve, etc.
                delay: 0, //milliseconds
                iterations: 1, //or a number
                direction: 'normal', //'normal', 'reverse', etc.
                fill: 'forwards' //'backwards', 'both', 'none', 'auto'
            });
        
            // Check and see if the user had a text selection range
            var currentRange;
            if (document.getSelection().rangeCount > 0) {
                // If user has a text selection range, store it
                currentRange = document.getSelection().getRangeAt(0);
                // Remove the current selection
                window.getSelection().removeRange(currentRange);
            }
            else {
                // If user didn't have anything selected
                currentRange = false;
            }
        
            // Create a selection range
            var CopyRange = document.createRange();
            // Choose the element we want to select the text of
            CopyRange.selectNode(textToCopy);
            // Select the text inside the range
            window.getSelection().addRange(CopyRange);
            // Copy the text to the clipboard
            document.execCommand("copy");
        
            // Remove our selection range
            window.getSelection().removeRange(CopyRange);
        
            // Return the old selection range
            if (currentRange) {
                window.getSelection().addRange(currentRange);
            }
        }
    </script>
{% endblock js %}
